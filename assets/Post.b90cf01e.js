import{g as L,V as C,d as N,B as W,h as j,i as l,W as q,n as D,X as R,j as V,o as h,l as f,w as v,e as m,a as z,G as O,H as A,u as a,x as $,q as G,b as J,T as M,_ as U,N as X,J as Y}from"./app.4308d17d.js";import{a as I,_ as K}from"./Page.babc6a11.js";import{_ as Q}from"./Pager.48fce38e.js";const _=({headers:x,activeLink:n})=>{const r=L();return C("ul",{class:{catalog:!0}},x.map(o=>C("li",{class:{active:n===o.slug,[`level-${o.level}`]:!0,[`toc-link-${o.slug}`]:!0},key:o.title,onClick:()=>{r.currentRoute.value.hash!==`#${o.slug}`&&r.push(`#${o.slug}`)}},o.title)))};_.displayName="Catalog";_.props={headers:{type:Object,required:!0},activeLink:{type:String,default:""}};const oe=N({setup(x){const n=X(),r=W(),o=j(),b=L(),T=Y(),P=T.resolve,S=T.pending,c=l(()=>(o.value.catalog||r.value.catalog)&&n.value.headers.length>0),E=l(()=>c.value?n.value.headers:[]),k=t=>t.children.length>0?[t].concat(...t.children.map(k)):t,i=l(()=>[].concat(...E.value.map(k))),e=q({headerHeight:0,screenWidth:0,catalogTop:0,activeLink:"",isFixed:!1}),u=40,w=80,d=()=>{for(let s=i.value.length-1;s>=0;s--){const B=i.value[s].slug,H=document.querySelector(`#${B}`);if((H?H.getBoundingClientRect().top:0)<=100){e.activeLink=B;break}}window.pageYOffset>e.headerHeight+u-w?(e.isFixed=!0,e.catalogTop=w):(e.isFixed=!1,e.catalogTop=e.headerHeight+u),e.screenWidth<=719&&(e.catalogTop=-15)},p=()=>{const t=document.querySelector(".post-header");e.headerHeight=t?t.offsetHeight:0,e.screenWidth=document.body.clientWidth,e.screenWidth<=719?e.catalogTop=-15:e.catalogTop=e.headerHeight+u};let y;D(()=>{window.addEventListener("scroll",d),p(),window.onresize=()=>(()=>{p(),d()})(),y=b.afterEach(()=>{p()})}),R(()=>{window.removeEventListener("scroll",d),y()});const{post:g}=V(),F=l(()=>{if(!g.value)return{};const t=g.value.next;t&&(t.text=o.value.postNext);const s=g.value.prev;return s&&(s.text=o.value.postPrev),{next:t,prev:s}});return(t,s)=>(h(),f(U,null,{page:v(()=>[m(M,{name:"fade-slide-y",mode:"out-in",onBeforeEnter:a(P),onBeforeLeave:a(S)},{default:v(()=>[z("div",{class:$(["post-wrapper",{"show-catalog":a(c)}])},[O(m(I,{class:"post-header"},null,512),[[A,a(n).title]]),(h(),f(K,{key:a(n).path,class:"post-content"},{bottom:v(()=>[m(Q,{data:a(F)},null,8,["data"])]),_:1})),a(c)?(h(),f(a(_),{key:0,headers:a(i),"active-link":a(e).activeLink,class:$({fixed:a(e).isFixed}),style:G({top:`${a(e).catalogTop}px`})},null,8,["headers","active-link","class","style"])):J("",!0)],2)]),_:1},8,["onBeforeEnter","onBeforeLeave"])]),_:1}))}});export{oe as default};
