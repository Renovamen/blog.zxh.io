import{l as E,V as P,_ as N,f as z,H as D,g as R,W as V,m as v,X as W,s as q,Y as A,n as O,o as l,h as c,w as m,d as H,b as Y,y as j,z as J,i as o,k as L,J as S,v as M,T as U,C as X,L as G,B as I}from"./app.abcd7ed0.js";import{A as K,P as Q}from"./Page.2e49fd58.js";import{P as Z}from"./Pager.995f5998.js";import"./resolveTime.c884148f.js";const k=({headers:x,activeLink:n})=>{const r=E();return P("ul",{class:{catalog:!0}},x.map(a=>P("li",{class:{active:n===a.slug,[`level-${a.level}`]:!0,[`toc-link-${a.slug}`]:!0},key:a.title,onClick:()=>{r.currentRoute.value.hash!==`#${a.slug}`&&r.push(`#${a.slug}`)}},a.title)))};k.displayName="Catalog";k.props={headers:{type:Object,required:!0},activeLink:{type:String,default:""}};const ee=z({name:"Post",setup(x){const n=G();D();const r=R(),a=E(),w=I(),b=w.resolve,F=w.pending,i=V(),$=v(()=>i.value?n.value.headers:[]),y=t=>t.children.length>0?[t].concat(...t.children.map(y)):t,u=v(()=>[].concat(...$.value.map(y))),e=W({headerHeight:0,screenWidth:0,catalogTop:0,activeLink:"",isFixed:!1}),d=40,T=80,p=()=>{for(let s=u.value.length-1;s>=0;s--){const B=u.value[s].slug,C=document.querySelector(`#${B}`);if((C?C.getBoundingClientRect().top:0)<=100){e.activeLink=B;break}}window.pageYOffset>e.headerHeight+d-T?(e.isFixed=!0,e.catalogTop=T):(e.isFixed=!1,e.catalogTop=e.headerHeight+d)},g=()=>{const t=document.querySelector(".post-header");e.headerHeight=t?t.offsetHeight:0,e.screenWidth=document.body.clientWidth,e.catalogTop=e.headerHeight+d};let _;q(()=>{window.addEventListener("scroll",p),g(),window.onresize=()=>(()=>{g(),p()})(),_=a.afterEach(()=>{g()})}),A(()=>{window.removeEventListener("scroll",p),_()});const{post:f}=O(),h=v(()=>{if(!f.value)return{};const t=f.value.info.next;t&&(t.text=r.value.postNext);const s=f.value.info.prev;return s&&(s.text=r.value.postPrev),{next:t,prev:s}});return(t,s)=>(l(),c(X,null,{page:m(()=>[H(U,{name:"fade-slide-y",mode:"out-in",onBeforeEnter:o(b),onBeforeLeave:o(F)},{default:m(()=>[Y("div",{class:S(["post-wrapper",{"show-catalog":o(i)}])},[j(H(K,{class:"post-header"},null,512),[[J,o(n).title]]),(l(),c(Q,{key:o(n).path,class:"post-content"},{bottom:m(()=>[o(h).next||o(h).prev?(l(),c(Z,{key:0,data:o(h)},null,8,["data"])):L("",!0)]),_:1})),o(i)?(l(),c(o(k),{key:0,headers:o(u),"active-link":e.activeLink,class:S({fixed:e.isFixed}),style:M({top:`${e.catalogTop}px`})},null,8,["headers","active-link","class","style"])):L("",!0)],2)]),_:1},8,["onBeforeEnter","onBeforeLeave"])]),_:1}))}});var re=N(ee,[["__file","Post.vue"]]);export{re as default};
