import{l as $,R as L,f as P,D,g as N,S as R,m as g,U as W,s as z,V,n as q,o as f,h,w as v,d as m,b as A,z as O,A as U,i as a,E as H,x as j,k as J,T as M,_ as Y,J as G,C as I}from"./app.5779336c.js";import{a as K,_ as Q}from"./Page.4cbd0bef.js";import{_ as X}from"./Pager.da5b8865.js";const _=({headers:k,activeLink:n})=>{const r=$();return L("ul",{class:{catalog:!0}},k.map(o=>L("li",{class:{active:n===o.slug,[`level-${o.level}`]:!0,[`toc-link-${o.slug}`]:!0},key:o.title,onClick:()=>{r.currentRoute.value.hash!==`#${o.slug}`&&r.push(`#${o.slug}`)}},o.title)))};_.displayName="Catalog";_.props={headers:{type:Object,required:!0},activeLink:{type:String,default:""}};const oe=P({setup(k){const n=G();D();const r=N(),o=$(),x=I(),S=x.resolve,E=x.pending,l=R(),b=g(()=>l.value?n.value.headers:[]),T=t=>t.children.length>0?[t].concat(...t.children.map(T)):t,c=g(()=>[].concat(...b.value.map(T))),e=W({headerHeight:0,screenWidth:0,catalogTop:0,activeLink:"",isFixed:!1}),i=40,w=80,u=()=>{for(let s=c.value.length-1;s>=0;s--){const B=c.value[s].slug,C=document.querySelector(`#${B}`);if((C?C.getBoundingClientRect().top:0)<=100){e.activeLink=B;break}}window.pageYOffset>e.headerHeight+i-w?(e.isFixed=!0,e.catalogTop=w):(e.isFixed=!1,e.catalogTop=e.headerHeight+i),e.screenWidth<=719&&(e.catalogTop=-15)},d=()=>{const t=document.querySelector(".post-header");e.headerHeight=t?t.offsetHeight:0,e.screenWidth=document.body.clientWidth,e.screenWidth<=719?e.catalogTop=-15:e.catalogTop=e.headerHeight+i};let y;z(()=>{window.addEventListener("scroll",u),d(),window.onresize=()=>(()=>{d(),u()})(),y=o.afterEach(()=>{d()})}),V(()=>{window.removeEventListener("scroll",u),y()});const{post:p}=q(),F=g(()=>{if(!p.value)return{};const t=p.value.next;t&&(t.text=r.value.postNext);const s=p.value.prev;return s&&(s.text=r.value.postPrev),{next:t,prev:s}});return(t,s)=>(f(),h(Y,null,{page:v(()=>[m(M,{name:"fade-slide-y",mode:"out-in",onBeforeEnter:a(S),onBeforeLeave:a(E)},{default:v(()=>[A("div",{class:H(["post-wrapper",{"show-catalog":a(l)}])},[O(m(K,{class:"post-header"},null,512),[[U,a(n).title]]),(f(),h(Q,{key:a(n).path,class:"post-content"},{bottom:v(()=>[m(X,{data:a(F)},null,8,["data"])]),_:1})),a(l)?(f(),h(a(_),{key:0,headers:a(c),"active-link":a(e).activeLink,class:H({fixed:a(e).isFixed}),style:j({top:`${a(e).catalogTop}px`})},null,8,["headers","active-link","class","style"])):J("",!0)],2)]),_:1},8,["onBeforeEnter","onBeforeLeave"])]),_:1}))}});export{oe as default};
